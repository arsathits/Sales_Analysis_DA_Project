-- Cleansed Dim_customers Table --
SELECT c.CustomerKey AS CustomerKey,
c.FirstName as First_Name,
c.LastName AS Last_Name,
c.FirstName + ' ' + c.LastName AS Full_Name,
CASE c.gender WHEN 'M' THEN 'Male' WHEN 'F' THEN 'Female' END AS Gender,
C.DateFirstPurchase AS DateFirstPurchase,
g.city AS Customer_city
  FROM DimCustomer c
  JOIN DimGeography g
  ON c.GeographyKey = g.GeographyKey
ORDER BY CustomerKey ASC


-- Cleansed Dim_Date Table --
SELECT 
  [DateKey], 
  [FullDateAlternateKey] AS Date, 
  [EnglishDayNameOfWeek] AS Day, 
  [EnglishMonthName] AS Month, 
  LEFT([EnglishMonthName], 3) AS Monthshort, 
  [MonthNumberOfYear] AS MonthNO, 
  [CalendarQuarter] AS Quarter, 
  [CalendarYear] AS YEAR --[CalendarSemester]
FROM 
  [AdventureWorksDW2019].[dbo].[DimDate] 
WHERE 
  CalendarYear >= 2022

-- Cleansed Dim_Product Table --
SELECT 
  ProductKey, 
  p.ProductAlternateKey as Product_Item_Code, 
  p.EnglishProductName AS Product_Name, 
  ps.EnglishProductSubcategoryName AS Sub_Category, 
  pc.EnglishProductCategoryName AS Product_Category, 
  p.Color AS Product_Color, 
  p.Size AS Product_Size, 
  p.ProductLine AS Product_Line, 
  p.ModelName AS Product_Model_Name, 
  p.EnglishDescription AS Product_Description, 
  ISNULL (p.Status, 'Outdated') AS [Product Status] 
FROM 
  DimProduct AS p 
  LEFT JOIN DimProductSubcategory AS ps ON p.ProductSubcategoryKey = ps.ProductSubcategoryKey 
  LEFT JOIN DimProductCategory AS pc ON ps.ProductCategoryKey = pc.ProductCategoryKey
  ORDER BY p.ProductKey ASC

-- Cleansed Fact_Internetsales Table
SELECT 
  ProductKey, 
  OrderDateKey, 
  DueDateKey, 
  ShipDateKey, 
  CustomerKey, 
  SalesOrderNumber, 
  SalesAmount 
FROM 
  [AdventureWorksDW2019].[dbo].[FactInternetSales] 
WHERE 
  LEFT(OrderDateKey, 4) >= YEAR(GETDATE()) -2 -- Ensures we always only bring two years of date from extraction.
ORDER BY 
  OrderDateKey ASC
